# 开发工具指南

## Rust/Cargo 命令对照表

| JavaScript/pnpm | Rust/Cargo | 说明 |
|----------------|------------|------|
| `pnpm install` | `cargo build` | 安装依赖并构建 |
| `pnpm format` | `cargo fmt` | 格式化代码 |
| `pnpm lint` | `cargo clippy` | 代码质量检查 |
| `pnpm check` | `cargo check` | 快速类型检查 |
| `pnpm build` | `cargo build --release` | 生产构建 |
| `pnpm test` | `cargo test` | 运行测试 |
| `pnpm dev` | `cargo run` | 开发模式运行 |
| `pnpm clean` | `cargo clean` | 清理构建产物 |

## 使用 Makefile

项目包含 Makefile，提供便捷命令：

```bash
# 查看所有可用命令
make help

# 格式化代码
make format

# 运行代码检查
make lint

# 快速类型检查
make check

# 构建项目
make build

# 运行项目
make run

# 一键执行所有检查
make all
```

## VSCode 配置

### 推荐扩展

1. **rust-analyzer** - Rust 语言支持
2. **Even Better TOML** - TOML 文件支持
3. **crates** - Cargo.toml 依赖管理

### 设置建议

在 `.vscode/settings.json` 中添加：

```json
{
    "editor.formatOnSave": true,
    "[rust]": {
        "editor.defaultFormatter": "rust-lang.rust-analyzer"
    },
    "rust-analyzer.checkOnSave.command": "clippy"
}
```

## 解决 VSCode 警告

### 黄色波浪线（警告）
- **未使用的变量**：添加前缀 `_` 或使用 `#[allow(unused)]`
- **未使用的导入**：删除或使用 `cargo fix`
- **未使用的字段**：添加 `#[allow(dead_code)]`

### 红色波浪线（错误）
- **借用检查错误**：检查所有权和生命周期
- **类型不匹配**：确保类型正确
- **缺少导入**：添加 `use` 语句

## 常用修复命令

```bash
# 自动修复简单问题
cargo fix --allow-dirty

# 格式化所有代码
cargo fmt

# 检查并显示所有警告
cargo clippy -- -W clippy::all

# 只显示错误，忽略警告
cargo build 2>&1 | grep error
```

## 配置文件

### .rustfmt.toml
控制代码格式化规则

### clippy.toml
配置 clippy 检查规则

### Cargo.toml
项目配置和依赖管理

## 性能分析

```bash
# 构建优化版本
cargo build --release

# 运行基准测试
cargo bench

# 生成火焰图（需要安装 flamegraph）
cargo flamegraph
```

## 调试

```bash
# 启用所有日志
RUST_LOG=debug cargo run

# 启用回溯
RUST_BACKTRACE=1 cargo run

# 使用 VSCode 调试器
# 按 F5 或点击调试按钮
```